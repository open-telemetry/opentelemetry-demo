# Default values for opentelemetry-demo.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Namespace to deploy the demo into
namespace: otel-demo

# Global labels applied to all resources
global:
  labels:
    app.kubernetes.io/version: "2.1.3"
    app.kubernetes.io/part-of: opentelemetry-demo

# Grafana configuration
grafana:
  enabled: true
  adminUser: admin
  adminPassword: admin
  plugins: grafana-opensearch-datasource

# OpenSearch configuration
opensearch:
  enabled: true
  clusterName: opensearch-cluster
  maxUnavailable: 1

# Jaeger configuration
jaeger:
  enabled: true
  version: "1.53.0"

# OpenTelemetry Collector configuration
otelCollector:
  enabled: true
  version: "0.135.0"

  # Health check endpoint
  healthCheck:
    enabled: true
    port: 13133

  # Processors configuration
  processors:
    memoryLimiter:
      checkInterval: 5s
      limitPercentage: 80
      spikeLimitPercentage: 25

  # Exporters configuration
  exporters:
    opensearch:
      endpoint: http://opensearch:9200
      logsIndex: otel-logs
    jaeger:
      endpoint: jaeger-collector:4317
    prometheus:
      endpoint: http://prometheus:9090/api/v1/otlp

# Prometheus configuration
prometheus:
  enabled: true
  version: v3.6.0
  evaluationInterval: 1m
  scrapeInterval: 1m
  scrapeTimeout: 10s

  # OTLP configuration
  otlp:
    keepIdentifyingResourceAttributes: true
    promoteResourceAttributes:
      - service.instance.id
      - service.name
      - service.namespace
      - service.version
      - cloud.availability_zone
      - cloud.region
      - deployment.environment.name
      - k8s.cluster.name
      - k8s.container.name
      - k8s.cronjob.name
      - k8s.daemonset.name
      - k8s.deployment.name
      - k8s.job.name
      - k8s.namespace.name
      - k8s.node.name
      - k8s.pod.name
      - k8s.replicaset.name
      - k8s.statefulset.name
      - container.name
      - host.name
      - postgresql.database.name
      - postgresql.schema.name
      - postgresql.table.name
      - postgresql.index.name

# Feature flags configuration
featureFlags:
  productCatalogFailure: "off"
  recommendationCacheFailure: "off"
  adManualGc: "off"
  adHighCpu: "off"
  adFailure: "off"
  kafkaQueueProblems: "off"
  cartFailure: "off"
  paymentFailure: "off"
  paymentUnreachable: "off"
  loadGeneratorFloodHomepage: "off"
  imageSlowLoad: "off"

# Service account configuration
serviceAccount:
  create: true
  name: opentelemetry-demo
  automountServiceAccountToken: false

# Source: opentelemetry-demo/charts/grafana/templates/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: grafana
  namespace: {{ .Values.namespace }}
  labels:
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: opentelemetry-demo
    app.kubernetes.io/version: "12.1.1"
type: Opaque
data:
  admin-user: {{ .Values.grafana.adminUser | b64enc | quote }}
  admin-password: {{ .Values.grafana.adminPassword | b64enc | quote }}
  ldap-toml: ""
{{- if and .Values.adx.enabled .Values.grafana.adxDatasource }}
---
# ADX Service Principal credentials for Grafana datasource
# (ADX plugin v7.2.1 doesn't support Workload Identity)
apiVersion: v1
kind: Secret
metadata:
  name: grafana-adx-credentials
  namespace: {{ .Values.namespace }}
  labels:
    app.kubernetes.io/name: grafana
    app.kubernetes.io/instance: opentelemetry-demo
    app.kubernetes.io/component: grafana-adx-datasource
type: Opaque
stringData:
  tenant-id: {{ .Values.azure.tenantId | quote }}
  client-id: {{ .Values.grafana.adxDatasource.clientId | quote }}
  client-secret: {{ .Values.grafana.adxDatasource.clientSecret | quote }}
{{- end }}

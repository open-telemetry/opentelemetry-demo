# OpenTelemetry Demo - Service Dependencies

> A complete guide to service interactions in the OpenTelemetry Demo e-commerce application.

## Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND LAYER                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚   Frontend   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Frontend Proxy â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Load/Traffic â”‚   â”‚
â”‚    â”‚   (Next.js)  â”‚         â”‚    (Envoy)      â”‚         â”‚  Generator   â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            APPLICATION LAYER                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Product   â”‚  â”‚    Ad      â”‚  â”‚Recommend-  â”‚  â”‚       Checkout         â”‚â”‚
â”‚  â”‚  Catalog   â”‚  â”‚  Service   â”‚  â”‚  ation     â”‚  â”‚       Service          â”‚â”‚
â”‚  â”‚   (Go)     â”‚  â”‚  (Java)    â”‚  â”‚  (Python)  â”‚  â”‚         (Go)           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                               â”‚             â”‚
â”‚                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                           â”‚                                   â”‚         â”‚   â”‚
â”‚                           â–¼                                   â–¼         â–¼   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Cart     â”‚  â”‚  Payment   â”‚  â”‚  Shipping  â”‚  â”‚   Email   â”‚ Currency â”‚  â”‚
â”‚  â”‚  (DotNet)  â”‚  â”‚  (Node.js) â”‚  â”‚   (Rust)   â”‚  â”‚  (Ruby)   â”‚   (C++)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚              â”‚                                                     â”‚
â”‚        â–¼              â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                                                     â”‚
â”‚  â”‚   Quote    â”‚       â”‚                                                     â”‚
â”‚  â”‚   (PHP)    â”‚       â”‚                                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                                                     â”‚
â”‚                       â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ASYNC / MESSAGING LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚      â”‚                      Kafka                              â”‚             â”‚
â”‚      â”‚              (Message Queue)                            â”‚             â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                              â”‚                                               â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚              â–¼               â–¼               â–¼                              â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚      â”‚ Accounting â”‚  â”‚   Fraud    â”‚  â”‚  (Future)  â”‚                        â”‚
â”‚      â”‚  (DotNet)  â”‚  â”‚ Detection  â”‚  â”‚ Consumers  â”‚                        â”‚
â”‚      â”‚            â”‚  â”‚  (Kotlin)  â”‚  â”‚            â”‚                        â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            DATA LAYER                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚      â”‚ PostgreSQL â”‚         â”‚   Valkey   â”‚         â”‚   flagd    â”‚          â”‚
â”‚      â”‚ (Accountingâ”‚         â”‚   (Cart    â”‚         â”‚  (Feature  â”‚          â”‚
â”‚      â”‚    DB)     â”‚         â”‚   Cache)   â”‚         â”‚   Flags)   â”‚          â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Service Details

### Frontend Services

| Service | Language | Port | Description |
|---------|----------|------|-------------|
| **Frontend** | TypeScript/Next.js | 8080 | Web UI for browsing, cart, checkout |
| **Frontend Proxy** | Envoy | 8080 | API gateway, routes requests to services |
| **Traffic Generator** | Shell/curl | - | Generates synthetic traffic for testing |

### Core Business Services

| Service | Language | Port | Dependencies | Description |
|---------|----------|------|--------------|-------------|
| **Product Catalog** | Go | 3550 | None | Product database, search |
| **Cart** | .NET | 7070 | Valkey (Redis) | Shopping cart management |
| **Checkout** | Go | 5050 | Cart, Payment, Shipping, Email, Currency, Product Catalog | Order processing orchestrator |
| **Payment** | Node.js | 8080 | **flagd** | Credit card processing, **failure injection target** |
| **Shipping** | Rust | 8080 | Quote | Shipping cost calculation |
| **Quote** | PHP | 8080 | None | Shipping quote service |
| **Currency** | C++ | 7000 | None | Currency conversion |
| **Email** | Ruby | 6060 | None | Order confirmation emails |
| **Recommendation** | Python | 8080 | Product Catalog | Product recommendations |
| **Ad** | Java | 9555 | None | Advertisement service, **CPU injection target** |

### Async Consumers (Kafka)

| Service | Language | Consumes | Dependencies | Description |
|---------|----------|----------|--------------|-------------|
| **Accounting** | .NET | orders topic | PostgreSQL | Order accounting/ledger |
| **Fraud Detection** | Kotlin | orders topic | None | Fraud analysis |

### Infrastructure Services

| Service | Purpose | Used By |
|---------|---------|---------|
| **Kafka** | Message queue | Checkout â†’ Accounting, Fraud Detection |
| **PostgreSQL** | Accounting database | Accounting service |
| **Valkey (Redis)** | Cart cache | Cart service |
| **flagd** | Feature flags | Payment, Ad, Recommendation, Email |

---

## Detailed Dependency Chains

### ğŸ›’ Checkout Flow (Critical Path)

```
User clicks "Place Order"
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend Proxy   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ POST /api/checkout
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Checkout      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â”‚                                         â”‚
â”‚  1. GetCart() â”€â”€â”€â”€â”¼â”€â”€â–¶ Cart â”€â”€â–¶ Valkey                     â”‚
â”‚                   â”‚                                         â”‚
â”‚  2. GetProducts() â”¼â”€â”€â–¶ Product Catalog                     â”‚
â”‚                   â”‚                                         â”‚
â”‚  3. ConvertCurrency()â”€â”€â–¶ Currency                          â”‚
â”‚                   â”‚                                         â”‚
â”‚  4. GetShippingQuote()â”€â–¶ Shipping â”€â”€â–¶ Quote                â”‚
â”‚                   â”‚                                         â”‚
â”‚  5. ChargeCard() â”€â”¼â”€â”€â–¶ Payment â”€â”€â–¶ flagd (failure check)   â”‚ âš ï¸ FAILURE POINT
â”‚                   â”‚         â”‚                               â”‚
â”‚                   â”‚         â””â”€â”€â–¶ Throws Error if flag on   â”‚
â”‚                   â”‚                                         â”‚
â”‚  6. ShipOrder() â”€â”€â”¼â”€â”€â–¶ Shipping                            â”‚
â”‚                   â”‚                                         â”‚
â”‚  7. SendConfirmation()â”€â–¶ Email                             â”‚
â”‚                   â”‚                                         â”‚
â”‚  8. EmptyCart() â”€â”€â”¼â”€â”€â–¶ Cart                                â”‚
â”‚                   â”‚                                         â”‚
â”‚  9. PublishOrder()â”¼â”€â”€â–¶ Kafka â”€â”€â”¬â”€â”€â–¶ Accounting â”€â”€â–¶ PostgreSQL
â”‚                   â”‚            â””â”€â”€â–¶ Fraud Detection        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
          â”‚                                                   â”‚
          â–¼                                                   â”‚
   Return Order ID â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ  Homepage Load

```
User visits homepage
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Frontend      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼           â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Product â”‚ â”‚  Ad    â”‚ â”‚Recommendationâ”‚
â”‚Catalog â”‚ â”‚Service â”‚ â”‚   Service    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ Product  â”‚
                      â”‚ Catalog  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Failure Injection Points

| Scenario | Target Service | Flag Name | Effect on System |
|----------|---------------|-----------|------------------|
| **Payment Failure** | Payment | `paymentFailure` | Checkout fails, no orders complete |
| **High CPU** | Ad | `adHighCpu` | Slow homepage, degraded ads |
| **Memory Leak** | Email | `emailMemoryLeak` | Confirmation emails delayed/fail |
| **Cache Failure** | Recommendation | `recommendationCacheFailure` | Slow recommendations, DB overload |
| **Kafka Lag** | - | `kafkaQueueProblems` | Accounting/Fraud delayed |
| **Catalog Failure** | Product Catalog | `productCatalogFailure` | Can't browse/checkout products |

---

## Impact Analysis

### If Payment Service Fails

```
Payment âŒ
    â”‚
    â””â”€â”€â–¶ Checkout fails (500 error)
              â”‚
              â”œâ”€â”€â–¶ No orders created
              â”œâ”€â”€â–¶ No Kafka messages sent
              â”œâ”€â”€â–¶ No emails sent
              â”œâ”€â”€â–¶ No accounting entries
              â””â”€â”€â–¶ User sees error
```

### If Product Catalog Fails

```
Product Catalog âŒ
    â”‚
    â”œâ”€â”€â–¶ Frontend can't show products
    â”œâ”€â”€â–¶ Recommendation service fails
    â”œâ”€â”€â–¶ Checkout can't validate products
    â””â”€â”€â–¶ Complete site outage
```

### If Kafka Fails

```
Kafka âŒ
    â”‚
    â”œâ”€â”€â–¶ Checkout still works (async)
    â”œâ”€â”€â–¶ Accounting not updated
    â”œâ”€â”€â–¶ Fraud detection stops
    â””â”€â”€â–¶ Data consistency issues
```

---

## Service Communication Protocols

| From | To | Protocol | Port |
|------|-----|----------|------|
| Frontend | Frontend Proxy | HTTP | 8080 |
| Frontend Proxy | All Services | gRPC | varies |
| Checkout | Payment | gRPC | 8080 |
| Checkout | Kafka | Kafka Protocol | 9092 |
| Cart | Valkey | Redis Protocol | 6379 |
| Accounting | PostgreSQL | PostgreSQL | 5432 |
| All Services | flagd | gRPC (OpenFeature) | 8013 |
| All Services | OTel Collector | OTLP (gRPC/HTTP) | 4317/4318 |

---

## Quick Reference: What Calls What

```
Frontend Proxy
â”œâ”€â”€ Product Catalog (GET /products)
â”œâ”€â”€ Cart (GET/POST /cart)
â”œâ”€â”€ Checkout (POST /checkout)
â”œâ”€â”€ Recommendation (GET /recommendations)
â”œâ”€â”€ Ad (GET /ads)
â”œâ”€â”€ Currency (GET /currencies)
â””â”€â”€ Shipping (GET /shipping)

Checkout
â”œâ”€â”€ Cart
â”œâ”€â”€ Product Catalog
â”œâ”€â”€ Currency
â”œâ”€â”€ Shipping
â”œâ”€â”€ Payment âš ï¸
â”œâ”€â”€ Email
â””â”€â”€ Kafka

Payment
â””â”€â”€ flagd (feature flag check)

Recommendation
â”œâ”€â”€ Product Catalog
â””â”€â”€ flagd

Ad
â””â”€â”€ flagd

Shipping
â””â”€â”€ Quote

Kafka Consumers
â”œâ”€â”€ Accounting â†’ PostgreSQL
â””â”€â”€ Fraud Detection
```

---

*Last updated: January 2026*

